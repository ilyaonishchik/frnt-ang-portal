<div class='grid'>
  <div class='col-12'>
    <div class='card'>

      <p-toolbar styleClass='mb-3 py-2'>
        <ng-template pTemplate='left'>
          <div class='my-2'>
            <button pButton label='Создать' icon='pi pi-plus' class='p-button-success mr-2' (click)='appendItem()'></button>
          </div>
        </ng-template>
      </p-toolbar>

      <p-table
        #dt
        dataKey='id'
        responsiveLayout="stack"
        styleClass="p-datatable-sm p-datatable-gridlines"
        [columns]='cols'
        [value]='items'
        [resizableColumns]="true"
        [lazy]='true'
        (onLazyLoad)='loadRoles($event)'
        [paginator]='true'
        [rows]='10'
        [showCurrentPageReport]='true'
        [loading]='loading'
        [totalRecords]='totalRecords'
        [rowsPerPageOptions]=rowsPerPageOptions
        currentPageReportTemplate='Записи с {first} по {last} из {totalRecords}'
        [globalFilterFields]="['name']"
      >
        <ng-template pTemplate="caption">
          <div class="flex align-items-center justify-content-between">
            <h5 class="m-0">Список ролей</h5>
            <span class="p-input-icon-left p-input-icon-right">
              <i class="pi pi-search"></i>
              <input
                #filter
                pInputText
                type="text"
                (input)="onGlobalFilter(dt, $event)"
                placeholder="Поиск..." />
              <i
                class="pi pi-times-circle"
                (click)="filter.value = ''; clearSearch(dt)"></i>
            </span>
          </div>
        </ng-template>
        <ng-template pTemplate='header' let-columns>
          <tr>
            <th
              *ngFor='let col of columns'
              pResizableColumn
              [pSortableColumn]='col.field'
              [ngClass]='col.width'>
              {{col.header}}
              <p-sortIcon [field]='col.field'></p-sortIcon>
            </th>
            <th class='w-4rem'>Статус</th>
            <th class='w-9rem'>Операции</th>
          </tr>
        </ng-template>
        <ng-template pTemplate='body' let-rowData let-columns='columns'>
          <tr>
            <td *ngFor='let col of columns'>
              <span class='p-column-title'>{{col.header}}</span>
              {{rowData[col.field]}}
            </td>
            <td class='text-center'>
              <span class='p-column-title'>Статус</span>
              <i
                class='pi'
                [ngClass]="{
                'pi-check-circle text-green-400': rowData['status'],
                'pi-times-circle text-red-400': !rowData['status']
                }">
              </i>
            </td>
            <td class='text-center'>
              <span class='p-column-title'>Операции</span>
              <span class='p-buttonset'>
                <button
                  pButton icon='pi pi-eye' class='p-button-raised p-button-text p-button-info p-button-xsm'
                  pTooltip='Просмотреть' tooltipPosition='bottom' [showDelay]='250'
                  (click)='viewItem(rowData)'>
                </button>
                <button
                  pButton icon='pi pi-pencil' class='p-button-raised p-button-text p-button-success p-button-xsm'
                  pTooltip='Изменить' tooltipPosition='bottom' [showDelay]='250'
                  (click)='editItem(rowData)'>
                </button>
                <button
                  pButton icon='pi pi-trash' class='p-button-raised p-button-text p-button-warning p-button-xsm'
                  pTooltip='Удалить' tooltipPosition='bottom' [showDelay]='250'
                  (click)='deleteItem(rowData)'>
                </button>
              </span>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
